<html>

<head>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/formio.full.min.css">
  <link rel="stylesheet" href="css/app.css">
  <script src="js/formio.full.min.js"></script>
  <script src="js/jquery.min.js"></script>
  <script type="text/javascript">
    window.onload = function () {
      // Creating from json schema file.
      Formio.createForm(document.getElementById('formio'), (function () {
        var json = null;
        $.ajax({
          'async': false,
          'global': false,
          'url': "json/fixedform.json",
          'dataType': "json",
          'success': function (data) {
            json = data;
          }
        });
        return json;
      })()).then(function (form) {
        // submit form
        form.on('submit', (submission) => {
          // setting data before call api
          var settings = {
            "crossDomain": true,
            "url": "https://togetherdemo.azure-api.net/calc/mul",
            "method": "POST",
            "headers": {
              "content-type": "application/json"
            },
            "data": "{\n\t\"a\": " + submission.data.a + ",\n\t\"b\": " + submission.data.a + "\n}"
          }
          // ajax call api
          $.ajax(settings).done(function (response) {
            console.log(response);
            form.submission = {
              data: {
                a: response.inputa,
                b: response.inputb,
                output: JSON.stringify(response.result)
              }
            };
            window.setTimeout(function () {
              $(".alert").fadeOut("slow");
            }, 3000);
          }).fail(function (error) {
            form.setAlert('danger', error.statusText);
            console.log(JSON.stringify(error.statusText));
          });
        });
        // submitDone Event
        form.on('submitDone', (submission) => {
          // something present
        });
      });

      var getsettings = {
        "async": true,
        "crossDomain": true,
        "url": "https://togetherdemo.azure-api.net/calc/mul",
        "method": "GET"
      }

      $.ajax(getsettings).done(function (response) {
        var html = "";
        $.each(response, function (key, value) {
          var res_id = JSON.stringify(value.ID);
          var res_inputA = JSON.stringify(value.InputA);
          var res_inputB = JSON.stringify(value.InputB);
          var res_result = JSON.stringify(value.Result);
          var res_datetimeStamp = JSON.stringify(value.Datetimestamp);
          // html += "<p class='info'><strong>ID: " + res_id + "</strong> (" + res_inputA + " x " + res_inputB + ") = " + res_result + " Date: " + res_datetimeStamp + "</p>";
        });
        $("#result").append(html);
      });
    };
  </script>
</head>

<body>
  <div class="container-fuild">
    <div class="jumbotron">
      <h1 style="text-align:center"> MULTIPLY FORM</h1>
    </div>
    <div class="col-lg-4" id="result"></div>
    <div class="col-lg-4" id="formio"></div>
    <div class="col-lg-4" id="formio2"></div>
  </div>
</body>

</html>