<html>

<head>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/formio.full.min.css">
  <link rel="stylesheet" href="css/app.css">
  <script src="js/formio.full.min.js"></script>
  <script src="js/jquery.min.js"></script>
  <script src="js/moment.min.js"></script>
  <script src="js/loadJsonForm.js"></script>
</head>

<body>

  <div class="container-fuild">
    <div class="jumbotron">
      <h1 style="text-align:center">MULTIPLY FORM</h1>
    </div>
    <div class="col-lg-4" id="formio1"></div>
    <div class="col-lg-4" id="formio2"></div>
    <div class="col-lg-4" id="formio3"></div>
    <div class="col-lg-4" id="formio4"></div>
    <div class="col-lg-4" id="formio5"></div>
    <div class="col-lg-4" id="formio6"></div>
    <div class="col-lg-4" id="formio7"></div>
    <div class="col-lg-4" id="formio8"></div>
    <div class="col-lg-4" id="formio9"></div>
    <div class="col-lg-4" id="formio10"></div>
    <div class="col-lg-4" id="formio11"></div>
    <div class="col-lg-4" id="formio12"></div>
  </div>

  <script type="text/javascript">
    window.onload = function () {

      // -------------------------------------------------------------------------------------------------------------------
      // Load form.io with json:loadJsonForm.js
      // -------------------------------------------------------------------------------------------------------------------

      Formio.createForm(document.getElementById('formio1'), arrForm[0]).then(function (instance) {

        // -----------------------------------------------
        // Trigger on submit event.
        // -----------------------------------------------

        instance.on('submit', (submission) => {

          var settings = {
            "crossDomain": true,
            "url": "https://together.azure-api.net/democalc/subtract?a=10&b=3&id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkhIQnlLVS0wRHFBcU1aaDZaRlBkMlZXYU90ZyIsImtpZCI6IkhIQnlLVS0wRHFBcU1aaDZaRlBkMlZXYU90ZyJ9.eyJhdWQiOiI1ODI5ZGFlNy04Zjg0LTQ3MGEtYjExYy02Y2YzMjU0NWYwNzQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zZTBiNmNiZC00OTU5LTRkMDEtODFiZi1jZTg4M2RkYWJkOTYvIiwiaWF0IjoxNTA3NTE5MzQ1LCJuYmYiOjE1MDc1MTkzNDUsImV4cCI6MTUwNzUyMzI0NSwiYWlvIjoiQVNRQTIvOEZBQUFBcithelh1VFlzV25FSDd5K0EvM0EwTVdOaC9iZlpuM2taNTJ1dHNSakptcz0iLCJhbXIiOlsicHdkIl0sImZhbWlseV9uYW1lIjoiS3Vsaml0dGl5YW5lZSIsImdpdmVuX25hbWUiOiJQb3JqZWQiLCJpcGFkZHIiOiIxODAuMTgzLjE4OC4xODciLCJuYW1lIjoiS3Vsaml0dGl5YW5lZSBQb3JqZWQgLSBUb2dldGhlciBUSCIsIm5vbmNlIjoiZGVmIiwib2lkIjoiM2MzNDE0MTYtOTUzZi00NWMxLTg4Y2EtMzcxMjNlMGM4ODJlIiwic3ViIjoibnZxTlY0MjQwbDUzTjIxWUQ0czh5SnBNNVNxRnE2ZzdnQTBSZlFBWjRhbyIsInRpZCI6IjNlMGI2Y2JkLTQ5NTktNGQwMS04MWJmLWNlODgzZGRhYmQ5NiIsInVuaXF1ZV9uYW1lIjoicC5rdWxqaXR0aXlhbmVlQHRvZ2V0aGVydGVhbS5jby50aCIsInVwbiI6InAua3Vsaml0dGl5YW5lZUB0b2dldGhlcnRlYW0uY28udGgiLCJ2ZXIiOiIxLjAifQ.RPypJ-4oV3MxT9LiONZic9ruwDHoyL2WUW6hb6-YxUhgJBcZjmwaq7ieQkvLuJT6GxfcS0J4fmZaSR3xd9g1GutOpiaRji4tVu9PPLPPMSI8OkhYEd1yT3lwIUP5VQZ_jVEt26lZrEfdqC8KV1kKZZS09uJLhZRxT_1veCc_I8Qgui8wMFOj2a8F8tNGfStI2wca7nCzBSzlIRmWHa1t8zFro4-hTHqu0jup4RZq0QY9spU1E4BqM_0nxmaZJUgJYLZSRAt2322fIkExwD4yMnv3KxLsfT8HCWOUQFfercTlOhWNY7xq5cAzTGYA1znO89n8VcO1eoc5c2LYOB6g36Q",
            "method": "GET"
          }

          // -----------------------------------------------
          // Insert data to database.
          // -----------------------------------------------

          $.ajax(settings).done(function (response) {
            console.log('inserted to datacase successfully.');
            instance.setAlert('success', 'inserted to datacase successfully.');
            window.setTimeout(function () { $(".alert").fadeOut("slow"); }, 2000);

            var res_id = JSON.stringify(response.ID);
            var res_inputA = JSON.stringify(response.InputA);
            var res_inputB = JSON.stringify(response.InputB);
            var res_result = JSON.stringify(response.Result);
            var res_datetimeStamp = response.Datetimestamp;

            var res_html =
              "<p class='info'>" +
              "<strong>ID: " + res_id + "</strong> " +
              "(" + res_inputA + " x " + res_inputB + ") = " + res_result +
              "<span class='pull-right' style='color:blue'>" + res_datetimeStamp + "</span>" +
              "</p>";

            $("#result").prepend(res_html);

          }).fail(function (error) {
            console.log(JSON.stringify(error.statusText));
            instance.setAlert('danger', error.statusText);
          });
        });
      });

      Formio.createForm(document.getElementById('formio2'), arrForm[1]).then(function (instance) {

        // -----------------------------------------------
        // Trigger on submit event.
        // -----------------------------------------------

        instance.on('submit', (submission) => {

          var settings = {
            "crossDomain": true,
            "url": "https://togetherdemo.azure-api.net/calc/mul",
            "method": "POST",
            "headers": { "content-type": "application/json" },
            "data": "{\n\t\"a\": " + submission.data.a + ",\n\t\"b\": " + submission.data.b + "\n}"
          }

          // -----------------------------------------------
          // Insert data to database.
          // -----------------------------------------------

          $.ajax(settings).done(function (response) {
            console.log('inserted to datacase successfully.');
            instance.setAlert('success', 'inserted to datacase successfully.');
            window.setTimeout(function () { $(".alert").fadeOut("slow"); }, 2000);

            var res_id = JSON.stringify(response.ID);
            var res_inputA = JSON.stringify(response.InputA);
            var res_inputB = JSON.stringify(response.InputB);
            var res_result = JSON.stringify(response.Result);
            var res_datetimeStamp = response.Datetimestamp;

            var res_html =
              "<div class='alert alert-info'>" +
              "<strong> ID: " + res_id + " </strong>" +
              " (" + res_inputA + " x " + res_inputB + ") = " + res_result +
              "<span class='pull-right' style='color:blue'>" + res_datetimeStamp + "</span>" +
              "</div>";

            $("#result").prepend(res_html);

          }).fail(function (error) {
            console.log(JSON.stringify(error.statusText));
            instance.setAlert('danger', error.statusText);
          });
        });
      });
      Formio.createForm(document.getElementById('formio3'), arrForm[2]);
      Formio.createForm(document.getElementById('formio4'), arrForm[3]);
      Formio.createForm(document.getElementById('formio5'), arrForm[4]);
      Formio.createForm(document.getElementById('formio6'), arrForm[5]);
      Formio.createForm(document.getElementById('formio7'), arrForm[6]);
      Formio.createForm(document.getElementById('formio8'), arrForm[7]);
      Formio.createForm(document.getElementById('formio9'), arrForm[8]);
      Formio.createForm(document.getElementById('formio10'), arrForm[9]);
      Formio.createForm(document.getElementById('formio11'), arrForm[10]);
      Formio.createForm(document.getElementById('formio12'), arrForm[11]);
    };
  </script>
</body>

</html>